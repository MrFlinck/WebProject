(VariantData.Type == VarEnum.VT_EMPTY);
                                    VariantData.Clear();

                                    // Check to see if the device is RAW capable by selecting the Device Capabilities
                                    // flag from the Property Store and examining the proper bit in the bitfield.
                                    ResultCode = PropertyStore.GetValue(ref PKEY_Device_Capabilities, ref VariantData);
                                    RawCapable = (RAW_DEVICE_OK_FLAG == (Convert.ToUInt32(VariantData.Value) & RAW_DEVICE_OK_FLAG));
                                    VariantData.Clear();

                                    // If a device is RAW capable and has no driver then it should be excluded from
                                    // the device info array.
                                    if (0 != ConfigManagerErrorCode || (NoDriver && !RawCapable))
                                    {
                                        ResultDeviceInfo.Type = HardDeviceType.PNPDevice;
                                        DeviceInfoArray.Add(ResultDeviceInfo); // copies current value into new array element
                                    }
                                }
                                Marshal.Release(PropertyStorePtr);
                            }
                        }
                        Marshal.Release(FunctionInstancePtr);
                    }
                }
                Marshal.Release(FICollectionPtr);
            }
        }
