
        }

        [Guid("33591C10-0BED-4F02-B0AB-1530D5533EE9"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
        public interface IFunctionInstance
        {
            UInt32 QueryService(ref Guid guidService, ref Guid riid, ref IntPtr ppvObject);

            UInt32 GetID([MarshalAs(UnmanagedType.LPWStr)] ref string ppszCoMemIdentity);

            UInt32 GetProviderInstanceID([MarshalAs(UnmanagedType.LPWStr)] ref string ppszCoMemProviderInstanceIdentity);

            UInt32 OpenPropertyStore(UInt32 dwStgAccess, ref IntPtr ppIPropertyStore);

            UInt32 GetCategory([MarshalAs(UnmanagedType.LPWStr)] ref string ppszCoMemCategory, [MarshalAs(UnmanagedType.LPWStr)] ref string ppszCoMemSubCategory);
        }

        [Guid("886d8eeb-8cf2-4446-8d02-cdba1dbdcf99"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
        public interface IPropertyStore
        {
            UInt32 GetCount(ref UInt32 cProps);

            UInt32 GetAt(UInt32 iProp, ref PROPERTYKEY pkey);

            UInt32 GetValue(ref PROPERTYKEY key, ref PropVariant pv);

            UInt32 SetValue(ref PROPERTYKEY key, ref PropVariant propvar);

            UInt32 Commit();
        };

        #endregion

        public static bool IsPrinterDevice(IFunctionInstance DeviceDisplayObject, ref DeviceInfo printerInfo)
        {
            bool isPrinter = false;
            Guid devicTypeID = Guid.Empty;
            UInt32 serviceCount = 0;
            UInt32 deviceFunctionCount = 0;

            IntPtr deviceFICo